{"version":3,"file":"static/js/3220.0499c442.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/renderers/support/heatmapUtils.js","../node_modules/@arcgis/core/views/2d/layers/features/processors/BaseProcessor.js","../node_modules/@arcgis/core/views/2d/layers/features/processors/HeatmapProcessor.js","../node_modules/@arcgis/core/views/2d/layers/features/support/tileUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../core/mathUtils.js\";import{px2pt as r,pt2px as n}from\"../../core/screenUtils.js\";import{l as o}from\"../../chunks/vec4.js\";import{c as e}from\"../../chunks/vec4f64.js\";const a=2.4;function i(t){return r(t*a)}function c(t){return n(t)/a}function f(r,n,e,a){let{color:i,ratio:c}=n,{color:f,ratio:u}=e;if(u===c){const t=1e-6;1===u?c-=t:u+=t}const s=t((a-c)/(u-c),0,1);o(r,i.toArray(),f.toArray(),s)}function u(t){const r=512,n=new Uint8ClampedArray(4*r);if(t=t.filter((({ratio:t})=>t>=0&&t<=1)).sort(((t,r)=>t.ratio-r.ratio)).map((({color:t,ratio:r})=>({color:t,ratio:Math.max(r,.001)}))),t.length<1)return n;let o=t[0],a=t[0],i=1;const c=e();for(let e=0;e<r;e++){const u=(e+.5)/r;for(;u>a.ratio&&i<t.length;)o=a,a=t[i++];f(c,o,a,u),n.set(c,4*e)}return n}function s(t,r,o,e){const{radius:a,fieldOffset:i,field:c}=r,f=Math.round(n(a)),u=new Float64Array(o*e);let s,l=Number.NEGATIVE_INFINITY;const h=d(c,i),y=new Set;for(const n of t){const t=n.getCursor();for(;t.next();){const r=t.getObjectId();if(y.has(r))continue;y.add(r);const n=t.readLegacyPointGeometry(),a=128;if(n.x<-a||n.x>=o+a||n.y<-a||n.y>e+a)continue;const i=+h(t),c=Math.max(0,Math.round(n.x)-f),d=Math.max(0,Math.round(n.y)-f),g=Math.min(e,Math.round(n.y)+f),A=Math.min(o,Math.round(n.x)+f);for(let t=d;t<g;t++)for(let r=c;r<A;r++){const e=t*o+r,a=m(n.x-r,n.y-t,f);s=u[e]+=a*i,s>l&&(l=s)}}}return{matrix:u.buffer,max:l}}function l(t,r,n,o,e,a){t.canvas.width=t.canvas.height=r,t.clearRect(0,0,r,r);const i=t.getImageData(0,0,r,r);n&&o&&i.data.set(new Uint8ClampedArray(h(r,n,o,e,a))),t.putImageData(i,0,0)}function h(r,n,o,e,a){const i=new Uint32Array(r*r),c=\"buffer\"in n?n:new Float64Array(n),f=\"buffer\"in o?new Uint32Array(o.buffer):new Uint32Array(new Uint8Array(o).buffer),u=f.length/(a-e);for(let s=0;s<c.length;s++){const r=c[s],n=Math.floor((r-e)*u);i[s]=f[t(n,0,f.length-1)]}return i.buffer}function m(t,r,n){const o=Math.sqrt(t**2+r**2)/n;return o>1?0:3/(Math.PI*n**2)*(1-o**2)**2}function y(t,r){return\"function\"==typeof t?t:t?\"string\"==typeof r?r=>-1*+r[t]:n=>+n[t]+r:()=>1}function d(t,r){return null!=t?\"string\"==typeof r?r=>-1*+r.readAttribute(t):n=>+n.readAttribute(t)+r:t=>1}export{a as MAGIC_KERNEL_DENSITY_RADIUS_INFLATION_FACTOR,s as calculateHeatmapIntensityInfoReaders,h as createHeatmapImageData,y as createValueFunction,d as createValueFunctionCursor,l as drawHeatmap,m as evaluateDensityKernel,i as gaussianBlurRadiusPxToKernelDensityRadiusPt,u as generateGradient,c as kernelDensityRadiusPtToGaussianBlurRadiusPx};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{HandleOwner as r}from\"../../../../../core/HandleOwner.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/has.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";let s=class extends r{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const e=this.get(\"tileStore.tileScheme.spatialReference\");return e&&e.toJSON()||null}};e([t({readOnly:!0})],s.prototype,\"supportsTileUpdates\",null),e([t({constructOnly:!0})],s.prototype,\"remoteClient\",void 0),e([t({constructOnly:!0})],s.prototype,\"service\",void 0),e([t()],s.prototype,\"spatialReference\",null),e([t({constructOnly:!0})],s.prototype,\"tileInfo\",void 0),e([t({constructOnly:!0})],s.prototype,\"tileStore\",void 0),s=e([o(\"esri.views.2d.layers.features.processors.BaseProcessor\")],s);const p=s;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import{applySome as t}from\"../../../../../core/maybe.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/Error.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{diff as r}from\"../../../../../core/accessorSupport/diffUtils.js\";import{calculateHeatmapIntensityInfoReaders as i}from\"../../../../../renderers/support/heatmapUtils.js\";import{TILE_SIZE as o}from\"../../../engine/webgl/definitions.js\";import a from\"./BaseProcessor.js\";import{getPow2NeighborKey as n}from\"../support/tileUtils.js\";class d{constructor(e,t){this.offset=e,this.extent=t}}function l(e){const t=e.key,s=new Map,r=256,i=o,a=e.tileInfoView.tileInfo.isWrappable;return s.set(n(t,-1,-1,a).id,new d([-i,-i],[i-r,i-r,i,i])),s.set(n(t,0,-1,a).id,new d([0,-i],[0,i-r,i,i])),s.set(n(t,1,-1,a).id,new d([i,-i],[0,i-r,r,i])),s.set(n(t,-1,0,a).id,new d([-i,0],[i-r,0,i,i])),s.set(n(t,1,0,a).id,new d([i,0],[0,0,r,i])),s.set(n(t,-1,1,a).id,new d([-i,i],[i-r,0,i,r])),s.set(n(t,0,1,a).id,new d([0,i],[0,0,i,r])),s.set(n(t,1,1,a).id,new d([i,i],[0,0,r,r])),s}let p=class extends a{constructor(){super(...arguments),this.type=\"heatmap\",this._tileKeyToFeatureSets=new Map}initialize(){this.handles.add([this.tileStore.on(\"update\",this.onTileUpdate.bind(this))])}async update(e,t){const s=t.schema.processors[0];if(\"heatmap\"!==s.type)return;r(this._schema,s)&&(e.mesh=!0,this._schema=s)}onTileUpdate(e){for(const t of e.removed)this._tileKeyToFeatureSets.delete(t.key.id)}onTileClear(e){const t={clear:!0};return this._tileKeyToFeatureSets.delete(e.key.id),this.remoteClient.invoke(\"tileRenderer.onTileData\",{tileKey:e.id,data:t})}async onTileMessage(e,s,r){this._tileKeyToFeatureSets.has(e.key.id)||this._tileKeyToFeatureSets.set(e.key.id,new Map);const o=this._tileKeyToFeatureSets.get(e.key.id);if(o&&null!=s.addOrUpdate&&s.addOrUpdate.hasFeatures&&o.set(s.addOrUpdate.instance,s),s.end){const s=[],o=l(e);this._tileKeyToFeatureSets.forEach(((r,i)=>{if(i===e.key.id)r.forEach((e=>t(e.addOrUpdate,(e=>s.push(e)))));else if(o.has(i)){const e=o.get(i),[a,n]=e.offset;r.forEach((e=>t(e.addOrUpdate,(e=>{const t=e.transform(a,n,1,1);s.push(t)}))))}}));const a=i(s,this._schema.mesh,512,512),n={tileKey:e.key.id,intensityInfo:a},d=[a.matrix];return this.remoteClient.invoke(\"tileRenderer.onTileData\",n,{...r,transferList:d})}}onTileError(e,t,s){return this.remoteClient.invoke(\"tileRenderer.onTileError\",{tileKey:e.id,error:t},s)}};p=e([s(\"esri.views.2d.layers.features.processors.HeatmapProcessor\")],p);const c=p;export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nfunction o(o,l,c,r){const e=o.clone(),n=1<<e.level,t=e.col+l,w=e.row+c;return r&&t<0?(e.col=t+n,e.world-=1):t>=n?(e.col=t-n,e.world+=1):e.col=t,e.row=w,e}export{o as getPow2NeighborKey};\n"],"names":["a","i","t","r","c","n","f","e","color","ratio","u","s","o","toArray","Uint8ClampedArray","filter","_ref","sort","map","_ref2","Math","max","length","set","_step","radius","fieldOffset","field","round","Float64Array","l","Number","NEGATIVE_INFINITY","h","readAttribute","d","y","Set","_iterator","_createForOfIteratorHelper","done","value","getCursor","next","getObjectId","has","add","readLegacyPointGeometry","x","g","min","A","m","err","matrix","buffer","canvas","width","height","clearRect","getImageData","data","Uint32Array","Uint8Array","floor","putImageData","sqrt","pow","PI","_r","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","this","toJSON","readOnly","prototype","constructOnly","p","offset","extent","Map","tileInfoView","tileInfo","isWrappable","id","_a","_this","type","_tileKeyToFeatureSets","handles","tileStore","on","onTileUpdate","bind","_update","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","schema","processors","abrupt","_schema","mesh","stop","_x","_x2","removed","delete","remoteClient","invoke","tileKey","clear","_onTileMessage","_callee2","_s","_o","_a3","_n2","_d","_context2","addOrUpdate","hasFeatures","instance","end","forEach","push","_e$offset","_slicedToArray","transform","intensityInfo","_objectSpread","transferList","_x3","_x4","_x5","error","clone","level","col","w","row","world"],"sourceRoot":""}